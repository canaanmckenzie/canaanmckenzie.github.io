<!docytpe html>
<html lang="en">
    <head>
        <!-- meta -->
        <meta charset="utf-8">
        <meta name = "viewport" content="width=device-width, initial-scale=1.0">
        <link href="/assets/css/style.css" rel="stylesheet">
        <link href="/assets/css/prism-ghcolors.css" rel="stylesheet" />
        <link href="/assets/css/katex.min.css" rel="stylesheet"/>
        <title>First thoughts on HigherOrderCo's HVM</title>
    </head>
    <body>
        <div class="titlecard">
            <a href="/">~/</a> | <a href="/feed.xml">rss</a>
        </div>
        <h1>First thoughts on HigherOrderCo's HVM</h1>
<p>
    2023 03 02 </br>
    <strong>#</strong>
    
    <a href="/tags/start-ups">Start ups</a>, 
    
    <a href="/tags/rust">Rust</a>
    
</p>
<p>Well I've been looking at <a href="https://github.com/HigherOrderCO">HigherOrderCo's</a> HVM architecture again after I first noticed it a year ago. (It resurfaced on Hacker News recently, probably spurred by the hype around LLM's/fast/powerful computation and general enthusiasm for functional programming which has inexplicably struck up again. At a high-level it provides</p>
<p>an interesting paradigm of computation based on modifying lambda calculus to match part of <a href="https://dl.acm.org/doi/10.1145/96709.96711">Lamping's optimal reduction algorithm</a>, inspried by this <a href="https://www.sciencedirect.com/science/article/pii/S0890540197926432?ref=pdf_download&amp;fr=RR-2&amp;rr=7af8a9dc7dcb3ba6">book</a> and an adoption of previously well documented optimal evaluations in functional programming. <em>The Optimal Implementation of Functional Programming Languages (Cambridge Tracts in Theoretical Computer Science, Series Number 45)</em> describes a &quot;reduction machine&quot; pages 14-39 which this emulates.</p>
<p>I'll add to this and probably more blog posts as I go through the early stages, but I thought I would write something down for now, I'll be breaking down the papers/models more in depth, and maybe glean some insight in how they can be optimized. (Spoiler, I have a fairly fast machine, and the example sequential function provided on the <a href="https://github.com/HigherOrderCO/HVM/blob/master/guide/README.md">Github Overview</a> ran 5x slower than as purported in the readme. based on the hvm built in timer and my own batch file measuring program run time). Although I take the point that measuring the &quot;cost&quot; is valuable because it is machine agnostic, however, I think this opens the door for some investigation into making it more efficient depending on the hardware. From my experience, scaling up hardware has lots of problems, especially when the maximum efficiency across a host of platforms is really a gold standard for how useful a programming paradigm is in the real world.</p>
<p>I've added the batch file below (although you'll notice the times differ slightly on the hvm timer vs mine, but the code is stil useful) if anyone wants some open source code to time operations on their windows machine have at it. Just add it to your path and run <code>timecmd</code> or whatever you call it in your terminal.</p>
<pre class="language-batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><br><span class="token operator">@</span><span class="token command"><span class="token keyword">setlocal</span></span><br><br><span class="token command"><span class="token keyword">set</span> <span class="token variable">start</span><span class="token operator">=</span><span class="token variable">%time%</span></span><br><br><span class="token command"><span class="token keyword">cmd</span> <span class="token parameter attr-name">/c</span> %*</span><br><br><span class="token command"><span class="token keyword">set</span> <span class="token variable">end</span><span class="token operator">=</span><span class="token variable">%time%</span></span><br><span class="token command"><span class="token keyword">set</span> <span class="token variable">options</span><span class="token operator">=</span><span class="token string">"tokens=1-4 delims=:.,"</span></span><br><span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token variable">%options%</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">"%start%"</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token variable">start_h</span><span class="token operator">=</span><span class="token variable">%%a</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">start_m</span><span class="token operator">=</span><span class="token number">100</span><span class="token variable">%%b</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token number">100</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">start_s</span><span class="token operator">=</span><span class="token number">100</span><span class="token variable">%%c</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token number">100</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">start_ms</span><span class="token operator">=</span><span class="token number">100</span><span class="token variable">%%d</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token number">100</span></span><br><span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/f</span> <span class="token variable">%options%</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">"%end%"</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token variable">end_h</span><span class="token operator">=</span><span class="token variable">%%a</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">end_m</span><span class="token operator">=</span><span class="token number">100</span><span class="token variable">%%b</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token number">100</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">end_s</span><span class="token operator">=</span><span class="token number">100</span><span class="token variable">%%c</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token number">100</span></span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">end_ms</span><span class="token operator">=</span><span class="token number">100</span><span class="token variable">%%d</span> <span class="token operator">%</span><span class="token operator">%</span> <span class="token number">100</span></span><br><br><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">hours</span><span class="token operator">=</span><span class="token variable">%end_h%</span><span class="token operator">-</span><span class="token variable">%start_h%</span></span><br><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">mins</span><span class="token operator">=</span><span class="token variable">%end_m%</span><span class="token operator">-</span><span class="token variable">%start_m%</span></span><br><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">secs</span><span class="token operator">=</span><span class="token variable">%end_s%</span><span class="token operator">-</span><span class="token variable">%start_s%</span></span><br><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">ms</span><span class="token operator">=</span><span class="token variable">%end_ms%</span><span class="token operator">-</span><span class="token variable">%start_ms%</span></span><br><span class="token command"><span class="token keyword">if</span> <span class="token variable">%ms%</span> <span class="token operator">lss</span> <span class="token number">0</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> secs <span class="token operator">=</span> <span class="token variable">%secs%</span> <span class="token operator">-</span> <span class="token number">1</span> </span><span class="token operator">&amp;</span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> ms <span class="token operator">=</span> <span class="token number">100</span><span class="token variable">%ms%</span></span><br><span class="token command"><span class="token keyword">if</span> <span class="token variable">%secs%</span> <span class="token operator">lss</span> <span class="token number">0</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> mins <span class="token operator">=</span> <span class="token variable">%mins%</span> <span class="token operator">-</span> <span class="token number">1</span> </span><span class="token operator">&amp;</span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> secs <span class="token operator">=</span> <span class="token number">60</span><span class="token variable">%secs%</span></span><br><span class="token command"><span class="token keyword">if</span> <span class="token variable">%mins%</span> <span class="token operator">lss</span> <span class="token number">0</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> hours <span class="token operator">=</span> <span class="token variable">%hours%</span> <span class="token operator">-</span> <span class="token number">1</span> </span><span class="token operator">&amp;</span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> mins <span class="token operator">=</span> <span class="token number">60</span><span class="token variable">%mins%</span></span><br><span class="token command"><span class="token keyword">if</span> <span class="token variable">%hours%</span> <span class="token operator">lss</span> <span class="token number">0</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> hours <span class="token operator">=</span> <span class="token number">24</span><span class="token variable">%hours%</span></span><br><span class="token command"><span class="token keyword">if</span> <span class="token number">1</span><span class="token variable">%ms%</span> <span class="token operator">lss</span> <span class="token number">100</span></span> <span class="token command"><span class="token keyword">set</span> <span class="token variable">ms</span><span class="token operator">=</span><span class="token number">0</span><span class="token variable">%ms%</span></span><br><br><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> totalsecs <span class="token operator">=</span> <span class="token variable">%hours%</span><span class="token operator">*</span><span class="token number">3600</span> <span class="token operator">+</span> <span class="token variable">%mins%</span><span class="token operator">*</span><span class="token number">60</span> <span class="token operator">+</span> <span class="token variable">%secs%</span></span><br><span class="token command"><span class="token keyword">echo</span> command took <span class="token variable">%hours%</span>:<span class="token variable">%mins%</span>:<span class="token variable">%secs%</span>.<span class="token variable">%ms%</span> (<span class="token variable">%totalsecs%</span>.<span class="token variable">%ms%</span>s total</span><span class="token punctuation">)</span></code></pre>
<p>Overall, I'm interested and skeptically enthusiastic about this, and there will definitely be more to come on this from me.</p>

</html>