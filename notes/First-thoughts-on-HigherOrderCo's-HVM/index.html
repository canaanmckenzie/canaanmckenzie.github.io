<!DOCTYPE html>
<html>
  <head>
<meta charset="utf-8">
<meta name = "viewport" content="width=device-width, initial-scaled=1.0"/>
<title>First thoughts on HigherOrderCo's HVM</title>
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="icon" href="/assets/images/favicon.ico">
<link type="application/atom+xml" rel="alternate" href="/feed.xml" />
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>First thoughts on HigherOrderCo’s HVM</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="First thoughts on HigherOrderCo’s HVM" />
<meta name="author" content="Canaan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Well I’ve been looking at HigherOrderCo’s HVM architecture again after I first noticed it a year ago. (It resurfaced on Hacker News recently, probably spurred by the hype around LLM’s/fast/powerful computation and general enthusiasm for functional programming which has inexplicably struck up again. At a high-level it provides an interesting paradigm of computation based on modifying lambda calculus to match part of Lamping’s optimal reduction algorithm, inspried by this book and an adoption of previously well documented optimal evaluations in functional programming. The Optimal Implementation of Functional Programming Languages (Cambridge Tracts in Theoretical Computer Science, Series Number 45) describes a “reduction machine” pages 14-39 which this emulates." />
<meta property="og:description" content="Well I’ve been looking at HigherOrderCo’s HVM architecture again after I first noticed it a year ago. (It resurfaced on Hacker News recently, probably spurred by the hype around LLM’s/fast/powerful computation and general enthusiasm for functional programming which has inexplicably struck up again. At a high-level it provides an interesting paradigm of computation based on modifying lambda calculus to match part of Lamping’s optimal reduction algorithm, inspried by this book and an adoption of previously well documented optimal evaluations in functional programming. The Optimal Implementation of Functional Programming Languages (Cambridge Tracts in Theoretical Computer Science, Series Number 45) describes a “reduction machine” pages 14-39 which this emulates." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-28T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="First thoughts on HigherOrderCo’s HVM" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Canaan"},"dateModified":"2023-03-28T00:00:00-04:00","datePublished":"2023-03-28T00:00:00-04:00","description":"Well I’ve been looking at HigherOrderCo’s HVM architecture again after I first noticed it a year ago. (It resurfaced on Hacker News recently, probably spurred by the hype around LLM’s/fast/powerful computation and general enthusiasm for functional programming which has inexplicably struck up again. At a high-level it provides an interesting paradigm of computation based on modifying lambda calculus to match part of Lamping’s optimal reduction algorithm, inspried by this book and an adoption of previously well documented optimal evaluations in functional programming. The Optimal Implementation of Functional Programming Languages (Cambridge Tracts in Theoretical Computer Science, Series Number 45) describes a “reduction machine” pages 14-39 which this emulates.","headline":"First thoughts on HigherOrderCo’s HVM","mainEntityOfPage":{"@type":"WebPage","@id":"/notes/First-thoughts-on-HigherOrderCo's-HVM/"},"url":"/notes/First-thoughts-on-HigherOrderCo's-HVM/"}</script>
<!-- End Jekyll SEO tag -->


<script type="text/javascript" async src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML'></script>

</head>
  <body class="full-width">
    <header>
    <nav class= "group">
        <a href="/"><img class="badge" src="/assets/img/ghosty.png" alt="CM"></a>
        <a href="/">Home</a>
        <a href="/about">about</a>
    </nav>
</header>
    <article>
      <h1>First thoughts on HigherOrderCo's HVM</h1>
<p class="subtitle">March 28, 2023</p>


<p>Well I’ve been looking at <a href="https://github.com/HigherOrderCO">HigherOrderCo’s</a> HVM architecture again after I first noticed it a year ago. (It resurfaced on Hacker News recently, probably spurred by the hype around LLM’s/fast/powerful computation and general enthusiasm for functional programming which has inexplicably struck up again. At a high-level it provides
an interesting paradigm of computation based on modifying lambda calculus to match part of <a href="https://dl.acm.org/doi/10.1145/96709.96711">Lamping’s optimal reduction algorithm</a>, inspried by this <a href="https://www.sciencedirect.com/science/article/pii/S0890540197926432?ref=pdf_download&amp;fr=RR-2&amp;rr=7af8a9dc7dcb3ba6">book</a> and an adoption of previously well documented optimal evaluations in functional programming. <em>The Optimal Implementation of Functional Programming Languages (Cambridge Tracts in Theoretical Computer Science, Series Number 45)</em> describes a “reduction machine” pages 14-39 which this emulates.</p>

<p>I’ll add to this and probably more blog posts as I go through the early stages, but I thought I would write something down for now, I’ll be breaking down the papers/models more in depth, and maybe glean some insight in how they can be optimized. (Spoiler, I have a fairly fast machine, and the example sequential function provided on the <a href="https://github.com/HigherOrderCO/HVM/blob/master/guide/README.md">Github Overview</a> ran 5x slower than as purported in the readme. based on the hvm built in timer and my own batch file measuring program run time). Although I take the point that measuring the “cost” is valuable because it is machine agnostic, however, I think this opens the door for some investigation into making it more efficient depending on the hardware. From my experience, scaling up hardware has lots of problems, especially when the maximum efficiency across a host of platforms is really a gold standard for how useful a programming paradigm is in the real world.</p>

<figure>
<p><img src="/assets/img/hvm_sum_time.png" alt="first benchmark" /></p>
</figure>

<p>I’ve added the batch file below (although you’ll notice the times differ slightly on the hvm timer vs mine, but the code is stil useful) if anyone wants some open source code to time operations on their windows machine have at it. Just add it to your path and run <code class="language-plaintext highlighter-rouge">timecmd</code> or whatever you call it in your terminal.</p>

<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@echo <span class="na">off</span>
@setlocal

<span class="kd">set</span> <span class="nb">start</span><span class="o">=</span><span class="nv">%time%</span>

<span class="nb">cmd</span> <span class="na">/c </span><span class="err">%</span><span class="o">*</span>

<span class="kd">set</span> <span class="kd">end</span><span class="o">=</span><span class="nv">%time%</span>
<span class="kd">set</span> <span class="kd">options</span><span class="o">=</span><span class="s2">"tokens=1-4 delims=:.,"</span>
<span class="k">for</span> <span class="na">/f </span><span class="nv">%options%</span> <span class="vm">%%a</span> <span class="k">in</span> <span class="o">(</span><span class="s2">"</span><span class="nv">%start%</span><span class="s2">"</span><span class="o">)</span> <span class="k">do</span> <span class="kd">set</span> <span class="kd">start_h</span><span class="o">=</span><span class="vm">%%a</span><span class="o">&amp;</span><span class="kd">set</span> <span class="na">/a </span><span class="kd">start_m</span><span class="o">=</span><span class="m">100</span><span class="vm">%%b</span> <span class="err">%%</span> <span class="m">100</span><span class="o">&amp;</span><span class="kd">set</span> <span class="na">/a </span><span class="kd">start_s</span><span class="o">=</span><span class="m">100</span><span class="vm">%%c</span> <span class="err">%%</span> <span class="m">100</span><span class="o">&amp;</span><span class="kd">set</span> <span class="na">/a </span><span class="kd">start_ms</span><span class="o">=</span><span class="m">100</span><span class="vm">%%d</span> <span class="err">%%</span> <span class="m">100</span>
<span class="k">for</span> <span class="na">/f </span><span class="nv">%options%</span> <span class="vm">%%a</span> <span class="k">in</span> <span class="o">(</span><span class="s2">"</span><span class="nv">%end%</span><span class="s2">"</span><span class="o">)</span> <span class="k">do</span> <span class="kd">set</span> <span class="kd">end_h</span><span class="o">=</span><span class="vm">%%a</span><span class="o">&amp;</span><span class="kd">set</span> <span class="na">/a </span><span class="kd">end_m</span><span class="o">=</span><span class="m">100</span><span class="vm">%%b</span> <span class="err">%%</span> <span class="m">100</span><span class="o">&amp;</span><span class="kd">set</span> <span class="na">/a </span><span class="kd">end_s</span><span class="o">=</span><span class="m">100</span><span class="vm">%%c</span> <span class="err">%%</span> <span class="m">100</span><span class="o">&amp;</span><span class="kd">set</span> <span class="na">/a </span><span class="kd">end_ms</span><span class="o">=</span><span class="m">100</span><span class="vm">%%d</span> <span class="err">%%</span> <span class="m">100</span>

<span class="kd">set</span> <span class="na">/a </span><span class="kd">hours</span><span class="o">=</span><span class="nv">%end_h%</span><span class="o">-</span><span class="nv">%start_h%</span>
<span class="kd">set</span> <span class="na">/a </span><span class="kd">mins</span><span class="o">=</span><span class="nv">%end_m%</span><span class="o">-</span><span class="nv">%start_m%</span>
<span class="kd">set</span> <span class="na">/a </span><span class="kd">secs</span><span class="o">=</span><span class="nv">%end_s%</span><span class="o">-</span><span class="nv">%start_s%</span>
<span class="kd">set</span> <span class="na">/a </span><span class="kd">ms</span><span class="o">=</span><span class="nv">%end_ms%</span><span class="o">-</span><span class="nv">%start_ms%</span>
<span class="k">if</span> <span class="nv">%ms%</span> <span class="ow">lss</span> <span class="m">0</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">secs</span> <span class="o">=</span> <span class="nv">%secs%</span> <span class="o">-</span> <span class="m">1</span> <span class="o">&amp;</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">ms</span> <span class="o">=</span> <span class="m">100</span><span class="nv">%ms%</span>
<span class="k">if</span> <span class="nv">%secs%</span> <span class="ow">lss</span> <span class="m">0</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">mins</span> <span class="o">=</span> <span class="nv">%mins%</span> <span class="o">-</span> <span class="m">1</span> <span class="o">&amp;</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">secs</span> <span class="o">=</span> <span class="m">60</span><span class="nv">%secs%</span>
<span class="k">if</span> <span class="nv">%mins%</span> <span class="ow">lss</span> <span class="m">0</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">hours</span> <span class="o">=</span> <span class="nv">%hours%</span> <span class="o">-</span> <span class="m">1</span> <span class="o">&amp;</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">mins</span> <span class="o">=</span> <span class="m">60</span><span class="nv">%mins%</span>
<span class="k">if</span> <span class="nv">%hours%</span> <span class="ow">lss</span> <span class="m">0</span> <span class="kd">set</span> <span class="na">/a </span><span class="kd">hours</span> <span class="o">=</span> <span class="m">24</span><span class="nv">%hours%</span>
<span class="k">if</span> <span class="m">1</span><span class="nv">%ms%</span> <span class="ow">lss</span> <span class="m">100</span> <span class="kd">set</span> <span class="kd">ms</span><span class="o">=</span><span class="m">0</span><span class="nv">%ms%</span>

<span class="kd">set</span> <span class="na">/a </span><span class="kd">totalsecs</span> <span class="o">=</span> <span class="nv">%hours%</span><span class="o">*</span><span class="m">3600</span> <span class="o">+</span> <span class="nv">%mins%</span><span class="o">*</span><span class="m">60</span> <span class="o">+</span> <span class="nv">%secs%</span>
<span class="nb">echo</span> <span class="kd">command</span> <span class="kd">took</span> <span class="nv">%hours%</span>:<span class="nv">%mins%</span>:<span class="nv">%secs%</span>.<span class="nv">%ms%</span> <span class="o">(</span><span class="nv">%totalsecs%</span>.<span class="nv">%ms%</span><span class="kd">s</span> <span class="kd">total</span><span class="o">)</span>
</code></pre></div></div>
<p>Overall, I’m interested and skeptically enthusiastic about this, and there will definitely be more to come on this from me.</p>


    </article>
    <div class="footer">
    <span>&2023 Canaan McKenzie. <a href="/feed.xml">Subscribe</a> via RSS</span>
</div>
  </body>
</html>